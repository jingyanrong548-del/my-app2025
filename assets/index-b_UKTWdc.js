(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))d(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&d(r)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();const v="app_links";function k(){try{const e=localStorage.getItem(v);return e?JSON.parse(e):[]}catch(e){return console.error("获取链接失败:",e),[]}}function y(e){try{return localStorage.setItem(v,JSON.stringify(e)),!0}catch(t){return console.error("保存链接失败:",t),!1}}function L(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}let l=[],E=null,h=null;function B(){l=k(),m()}function M(e){var i;const t={id:L(),title:e.title.trim(),url:e.url.trim(),description:((i=e.description)==null?void 0:i.trim())||"",createdAt:new Date().toISOString()};return l.push(t),y(l),m(),t}function b(e,t){var d;const i=l.findIndex(n=>n.id===e);return i!==-1?(l[i]={...l[i],title:t.title.trim(),url:t.url.trim(),description:((d=t.description)==null?void 0:d.trim())||""},y(l),m(),l[i]):null}function w(e){l=l.filter(t=>t.id!==e),y(l),m()}function S(){return E}function I(e){E=e}function D(){return h}function O(e){h=e}function C(e){if(e){let t=e;!e.startsWith("http://")&&!e.startsWith("https://")&&(t="https://"+e),window.open(t,"_blank","noopener,noreferrer")}}function m(){const e=document.getElementById("linksGrid"),t=document.getElementById("emptyState");!e||!t||(e.innerHTML="",l.length===0?(e.style.display="none",t.style.display="block"):(e.style.display="grid",t.style.display="none",l.forEach(i=>{const d=x(i);e.appendChild(d)})))}function x(e){const t=document.createElement("div");t.className="link-card",t.setAttribute("data-id",e.id);const i=T(e.url),d=i.charAt(0).toUpperCase();return t.innerHTML=`
    <div class="card-icon">${d}</div>
    <div class="card-content">
      <h3 class="card-title">${p(e.title)}</h3>
      ${e.description?`<p class="card-description">${p(e.description)}</p>`:""}
      <p class="card-url">${p(i)}</p>
    </div>
    <div class="card-actions">
      <button class="btn-icon btn-edit" data-id="${e.id}" aria-label="编辑" title="编辑">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
      </button>
      <button class="btn-icon btn-delete" data-id="${e.id}" aria-label="删除" title="删除">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
      </button>
    </div>
  `,t.querySelector(".card-content").addEventListener("click",s=>{s.target.closest(".card-actions")||C(e.url)}),t.querySelector(".btn-edit").addEventListener("click",s=>{s.stopPropagation(),I(e.id),U(e),g("linkModal")}),t.querySelector(".btn-delete").addEventListener("click",s=>{s.stopPropagation(),O(e.id),g("deleteModal")}),t}function T(e){try{let t=e;return!e.startsWith("http://")&&!e.startsWith("https://")&&(t="https://"+e),new URL(t).hostname.replace("www.","")}catch{return e}}function p(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}function U(e){document.getElementById("linkId").value=e.id,document.getElementById("linkTitle").value=e.title,document.getElementById("linkUrl").value=e.url,document.getElementById("linkDescription").value=e.description||"",document.getElementById("modalTitle").textContent="编辑链接"}function a(){document.getElementById("linkId").value="",document.getElementById("linkTitle").value="",document.getElementById("linkUrl").value="",document.getElementById("linkDescription").value="",document.getElementById("modalTitle").textContent="添加链接",I(null)}function g(e){const t=document.getElementById(e);t&&(t.style.display="flex",document.body.style.overflow="hidden")}function c(e){const t=document.getElementById(e);t&&(t.style.display="none",document.body.style.overflow="")}document.addEventListener("DOMContentLoaded",()=>{B(),$()});function $(){const e=document.getElementById("addBtn");e&&e.addEventListener("click",()=>{a(),g("linkModal")});const t=document.getElementById("linkForm");t&&t.addEventListener("submit",A);const i=document.getElementById("closeModal");i&&i.addEventListener("click",()=>{c("linkModal"),a()});const d=document.getElementById("cancelBtn");d&&d.addEventListener("click",()=>{c("linkModal"),a()});const n=document.getElementById("confirmDeleteBtn");n&&n.addEventListener("click",F);const o=document.getElementById("cancelDeleteBtn");o&&o.addEventListener("click",()=>{c("deleteModal")});const r=document.getElementById("closeDeleteModal");r&&r.addEventListener("click",()=>{c("deleteModal")});const s=document.getElementById("linkModal");s&&s.addEventListener("click",u=>{u.target===s&&(c("linkModal"),a())});const f=document.getElementById("deleteModal");f&&f.addEventListener("click",u=>{u.target===f&&c("deleteModal")}),document.addEventListener("keydown",u=>{u.key==="Escape"&&(c("linkModal"),c("deleteModal"),a())})}function A(e){e.preventDefault();const t=document.getElementById("linkTitle").value.trim(),i=document.getElementById("linkUrl").value.trim(),d=document.getElementById("linkDescription").value.trim(),n=document.getElementById("linkId").value;if(!t||!i){alert("请填写标题和URL");return}const o={title:t,url:i,description:d},r=S();r&&n===r?b(r,o):M(o),c("linkModal"),a()}function F(){const e=D();e&&(w(e),c("deleteModal"))}
