(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=o(i);fetch(i.href,r)}})();const V="app_links";function O(){try{const t=localStorage.getItem(V);return t?JSON.parse(t):[]}catch(t){return console.error("è·å–é“¾æ¥å¤±è´¥:",t),[]}}function y(t){try{return localStorage.setItem(V,JSON.stringify(t)),!0}catch(e){return console.error("ä¿å­˜é“¾æ¥å¤±è´¥:",e),!1}}function $(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}let c=[],D=null,C=null;function P(){c=O();let t=!1;c.forEach((e,o)=>{typeof e.order>"u"&&(e.order=o,t=!0),typeof e.version>"u"&&(e.version="1.0.0",t=!0)}),t&&y(c),c.sort((e,o)=>(e.order||0)-(o.order||0)),h()}function H(t){var n;const e=c.length>0?Math.max(...c.map(i=>i.order||0)):-1,o={id:$(),title:t.title.trim(),url:t.url.trim(),description:((n=t.description)==null?void 0:n.trim())||"",createdAt:new Date().toISOString(),order:e+1,version:t.version||"1.0.0",updatedAt:new Date().toISOString()};return c.push(o),y(c),h(),o}function U(t,e){var n;const o=c.findIndex(i=>i.id===t);return o!==-1?(c[o]={...c[o],title:e.title.trim(),url:e.url.trim(),description:((n=e.description)==null?void 0:n.trim())||"",version:e.version||c[o].version||"1.0.0",updatedAt:new Date().toISOString()},y(c),h(),c[o]):null}function F(t){c=c.filter(e=>e.id!==t),y(c),h()}function A(t){let e=0,o=0,i=(c.length>0?Math.max(...c.map(r=>r.order||0)):-1)+1;return t.forEach(r=>{var s,l;const a=r.url.trim(),d=c.findIndex(m=>m.url===a);if(d!==-1){const m=c[d],g=r.version||G(m.version||"1.0.0");c[d]={...m,title:r.title.trim(),description:((s=r.description)==null?void 0:s.trim())||m.description||"",version:g,updatedAt:new Date().toISOString()},o++}else{const m={id:$(),title:r.title.trim(),url:a,description:((l=r.description)==null?void 0:l.trim())||"",createdAt:new Date().toISOString(),order:i++,version:r.version||"1.0.0",updatedAt:new Date().toISOString()};c.push(m),e++}}),(e>0||o>0)&&(y(c),h()),{added:e,updated:o,skipped:0}}function G(t){const e=t.split(".").map(o=>parseInt(o)||0);return e[2]=(e[2]||0)+1,e.join(".")}function _(){return D}function T(t){D=t}function R(){return C}function N(t){C=t}function q(t){if(t){let e=t;!t.startsWith("http://")&&!t.startsWith("https://")&&(e="https://"+t),window.open(e,"_blank","noopener,noreferrer")}}function W(t,e){const o=c.findIndex(r=>r.id===t),n=c.findIndex(r=>r.id===e);if(o===-1||n===-1||o===n)return;const[i]=c.splice(o,1);c.splice(n,0,i),c.forEach((r,a)=>{r.order=a}),y(c),h()}function h(){const t=document.getElementById("linksGrid"),e=document.getElementById("emptyState");!t||!e||(t.innerHTML="",c.length===0?(t.style.display="none",e.style.display="block"):(t.style.display="grid",e.style.display="none",[...c].sort((n,i)=>(n.order||0)-(i.order||0)).forEach(n=>{const i=z(n);t.appendChild(i)})))}function z(t){const e=document.createElement("div");e.className="link-card",e.setAttribute("data-id",t.id);const o=J(t.url),n=o.charAt(0).toUpperCase(),i=t.version||"1.0.0";e.innerHTML=`
    <div class="card-drag-handle" title="æ‹–æ‹½æ’åº">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="9" cy="12" r="1"></circle>
        <circle cx="9" cy="5" r="1"></circle>
        <circle cx="9" cy="19" r="1"></circle>
        <circle cx="15" cy="12" r="1"></circle>
        <circle cx="15" cy="5" r="1"></circle>
        <circle cx="15" cy="19" r="1"></circle>
      </svg>
    </div>
    <div class="card-icon">${n}</div>
    <div class="card-content">
      <h3 class="card-title">${B(t.title)}</h3>
      ${t.description?`<p class="card-description">${B(t.description)}</p>`:""}
      <p class="card-url">${B(o)}</p>
      <p class="card-version">ç‰ˆæœ¬: ${B(i)}</p>
    </div>
    <div class="card-actions">
      <button class="btn-icon btn-edit" data-id="${t.id}" aria-label="ç¼–è¾‘" title="ç¼–è¾‘">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
      </button>
      <button class="btn-icon btn-delete" data-id="${t.id}" aria-label="åˆ é™¤" title="åˆ é™¤">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
      </button>
    </div>
  `;const r=e.querySelector(".card-drag-handle");return r&&(r.draggable=!0,r.addEventListener("mousedown",s=>{s.stopPropagation(),s.button===0&&(r.style.cursor="grabbing")}),r.addEventListener("mouseup",s=>{r.style.cursor="grab"}),r.addEventListener("dragstart",s=>{s.dataTransfer.effectAllowed="move",s.dataTransfer.setData("text/plain",t.id),s.dataTransfer.setData("text/html",t.id),e.classList.add("dragging"),s.dataTransfer.dropEffect="move"}),r.addEventListener("dragend",s=>{e.classList.remove("dragging"),document.querySelectorAll(".link-card").forEach(l=>l.classList.remove("drag-over")),r.style.cursor="grab"}),r.addEventListener("click",s=>{s.stopPropagation()})),e.addEventListener("dragover",s=>{s.preventDefault(),s.stopPropagation(),s.dataTransfer.dropEffect="move";const l=document.querySelector(".link-card.dragging");l&&l!==e&&e.classList.add("drag-over")}),e.addEventListener("dragleave",s=>{const l=s.relatedTarget;(!l||!e.contains(l))&&e.classList.remove("drag-over")}),e.addEventListener("drop",s=>{s.preventDefault(),s.stopPropagation(),e.classList.remove("drag-over");const l=s.dataTransfer.getData("text/plain")||s.dataTransfer.getData("text/html");l&&l!==t.id&&W(l,t.id)}),e.addEventListener("click",s=>{!s.target.closest(".card-actions")&&!s.target.closest(".card-drag-handle")&&q(t.url)}),e.querySelector(".btn-edit").addEventListener("click",s=>{s.stopPropagation(),T(t.id),Y(t),E("linkModal")}),e.querySelector(".btn-delete").addEventListener("click",s=>{s.stopPropagation(),N(t.id),E("deleteModal")}),e}function J(t){try{let e=t;return!t.startsWith("http://")&&!t.startsWith("https://")&&(e="https://"+t),new URL(e).hostname.replace("www.","")}catch{return t}}function B(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}function Y(t){document.getElementById("linkId").value=t.id,document.getElementById("linkTitle").value=t.title,document.getElementById("linkUrl").value=t.url,document.getElementById("linkDescription").value=t.description||"",document.getElementById("modalTitle").textContent="ç¼–è¾‘é“¾æ¥"}function f(){document.getElementById("linkId").value="",document.getElementById("linkTitle").value="",document.getElementById("linkUrl").value="",document.getElementById("linkDescription").value="",document.getElementById("modalTitle").textContent="æ·»åŠ é“¾æ¥",T(null)}function E(t){const e=document.getElementById(t);e&&(e.style.display="flex",document.body.style.overflow="hidden")}function u(t){const e=document.getElementById(t);e&&(e.style.display="none",document.body.style.overflow="")}async function K(t){try{const e=[];let o=1,n=!0;for(;n;){const i=await fetch(`https://api.github.com/users/${t}/repos?per_page=100&page=${o}&sort=updated`);if(!i.ok)throw new Error(`GitHub APIé”™è¯¯: ${i.status}`);const r=await i.json();r.length===0?n=!1:(e.push(...r),o++,r.length<100&&(n=!1))}return e}catch(e){throw console.error("è·å–GitHubä»“åº“å¤±è´¥:",e),e}}function j(t,e,o="my-app2025"){return t.filter(n=>n.name!==o&&!n.fork).map(n=>{let i=n.homepage;i||(i=`https://${e}.github.io/${n.name}/`);const r=n.homepage||i;return{title:n.name,url:r,description:n.description||`GitHubåº”ç”¨: ${n.name}`,homepage:n.homepage,githubPagesUrl:i,repoUrl:n.html_url,stars:n.stargazers_count,language:n.language,pushedAt:n.pushed_at||n.updated_at||new Date().toISOString(),updatedAt:n.updated_at||new Date().toISOString()}}).sort((n,i)=>i.stars!==n.stars?i.stars-n.stars:0)}async function Q(t,e){try{const o=await K(t),n=j(o,t);let i=0,r=0;const a=[];for(const d of n)try{const s=d.url;let l=d.description;d.language&&(l+=` | è¯­è¨€: ${d.language}`),d.stars>0&&(l+=` | â­ ${d.stars}`),d.homepage?l+=" | ğŸŒ å·²éƒ¨ç½²":l+=" | ğŸ“± GitHub Pages";const m=new Date(d.pushedAt||d.updatedAt||Date.now()),g=`${m.getFullYear()}.${String(m.getMonth()+1).padStart(2,"0")}.${String(m.getDate()).padStart(2,"0")}`;e({title:d.title,url:s,description:l,version:g}),i++}catch(s){a.push({repo:d.title,error:s.message}),r++}return{success:!0,total:n.length,imported:i,skipped:r,errors:a}}catch(o){return{success:!1,error:o.message}}}async function X(t){try{const e=[];let o=0,n=!0;for(;n;){const i=await fetch(`https://api.vercel.com/v9/projects?limit=100&until=${o}`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!i.ok)throw i.status===401?new Error("Vercel API Tokenæ— æ•ˆæˆ–å·²è¿‡æœŸ"):new Error(`Vercel APIé”™è¯¯: ${i.status}`);const r=await i.json();r.projects&&r.projects.length>0?(e.push(...r.projects),r.pagination&&r.pagination.hasNext?o=r.pagination.next:n=!1):n=!1}return e}catch(e){throw console.error("è·å–Vercelé¡¹ç›®å¤±è´¥:",e),e}}function Z(t){return t.filter(e=>e.productionDeployment||e.latestDeployment).map(e=>{const o=e.productionDeployment||e.latestDeployment;let n="";return e.alias&&e.alias.length>0?n=`https://${e.alias[0]}`:o&&o.url?n=o.url:e.name&&(n=`https://${e.name}.vercel.app`),{title:e.name,url:n,description:e.framework?`Vercelåº”ç”¨: ${e.name} | æ¡†æ¶: ${e.framework}`:`Vercelåº”ç”¨: ${e.name}`,framework:e.framework,deploymentUrl:(o==null?void 0:o.url)||"",createdAt:e.createdAt||new Date().toISOString(),updatedAt:e.updatedAt||new Date().toISOString()}}).sort((e,o)=>{const n=new Date(e.updatedAt||0);return new Date(o.updatedAt||0)-n})}async function ee(t,e){try{const o=await X(t),n=Z(o);let i=0,r=0;const a=[];for(const d of n)try{const s=new Date(d.updatedAt||Date.now()),l=`${s.getFullYear()}.${String(s.getMonth()+1).padStart(2,"0")}.${String(s.getDate()).padStart(2,"0")}`;e({title:d.title,url:d.url,description:d.description,version:l}),i++}catch(s){a.push({project:d.title,error:s.message})}return{success:!0,total:n.length,imported:i,updated:r,errors:a}}catch(o){return{success:!1,error:o.message}}}const te="1.0.0";document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("appVersion");t&&(t.textContent=`v${te}`),P(),ne()});function ne(){const t=document.getElementById("addBtn");t&&t.addEventListener("click",()=>{f(),E("linkModal")});const e=document.getElementById("linkForm");e&&e.addEventListener("submit",re);const o=document.getElementById("closeModal");o&&o.addEventListener("click",()=>{u("linkModal"),f()});const n=document.getElementById("cancelBtn");n&&n.addEventListener("click",()=>{u("linkModal"),f()});const i=document.getElementById("confirmDeleteBtn");i&&i.addEventListener("click",oe);const r=document.getElementById("cancelDeleteBtn");r&&r.addEventListener("click",()=>{u("deleteModal")});const a=document.getElementById("closeDeleteModal");a&&a.addEventListener("click",()=>{u("deleteModal")});const d=document.getElementById("linkModal");d&&d.addEventListener("click",p=>{p.target===d&&(u("linkModal"),f())});const s=document.getElementById("deleteModal");s&&s.addEventListener("click",p=>{p.target===s&&u("deleteModal")});const l=document.getElementById("importBtn");l&&l.addEventListener("click",()=>{E("importModal")});const m=document.getElementById("importVercelBtn");m&&m.addEventListener("click",()=>{E("importVercelModal")});const g=document.getElementById("closeImportModal");g&&g.addEventListener("click",()=>{u("importModal"),I()});const w=document.getElementById("cancelImportBtn");w&&w.addEventListener("click",()=>{u("importModal"),I()});const M=document.getElementById("confirmImportBtn");M&&M.addEventListener("click",ie);const L=document.getElementById("importModal");L&&L.addEventListener("click",p=>{p.target===L&&(u("importModal"),I())});const b=document.getElementById("closeImportVercelModal");b&&b.addEventListener("click",()=>{u("importVercelModal"),v()});const S=document.getElementById("cancelImportVercelBtn");S&&S.addEventListener("click",()=>{u("importVercelModal"),v()});const x=document.getElementById("confirmImportVercelBtn");x&&x.addEventListener("click",se);const k=document.getElementById("importVercelModal");k&&k.addEventListener("click",p=>{p.target===k&&(u("importVercelModal"),v())}),document.addEventListener("keydown",p=>{p.key==="Escape"&&(u("linkModal"),u("deleteModal"),u("importModal"),u("importVercelModal"),f(),I(),v())})}function re(t){t.preventDefault();const e=document.getElementById("linkTitle").value.trim(),o=document.getElementById("linkUrl").value.trim(),n=document.getElementById("linkDescription").value.trim(),i=document.getElementById("linkId").value;if(!e||!o){alert("è¯·å¡«å†™æ ‡é¢˜å’ŒURL");return}const r={title:e,url:o,description:n},a=_();a&&i===a?U(a,r):H(r),u("linkModal"),f()}function oe(){const t=R();t&&(F(t),u("deleteModal"))}async function ie(){const t=document.getElementById("githubUsername"),e=document.getElementById("importStatus"),o=document.getElementById("importMessage"),n=document.getElementById("progressBar"),i=document.getElementById("progressFill"),r=document.getElementById("confirmImportBtn"),a=t.value.trim();if(!a){alert("è¯·è¾“å…¥GitHubç”¨æˆ·å");return}e.style.display="block",o.textContent="æ­£åœ¨è·å–GitHubä»“åº“åˆ—è¡¨...",n.style.display="block",i.style.width="0%",r.disabled=!0,r.textContent="å¯¼å…¥ä¸­...";try{const d=[],s=await Q(a,l=>{d.push(l)});if(s.success){const l=A(d);i.style.width="100%",o.innerHTML=`
        âœ… å¯¼å…¥å®Œæˆï¼<br>
        å…±æ‰¾åˆ° ${s.total} ä¸ªä»“åº“<br>
        æ–°å¢ ${l.added} ä¸ªé“¾æ¥<br>
        æ›´æ–° ${l.updated} ä¸ªé“¾æ¥ï¼ˆç‰ˆæœ¬å·å·²æ›´æ–°ï¼‰
      `,setTimeout(()=>{u("importModal"),I()},3e3)}else o.textContent=`âŒ å¯¼å…¥å¤±è´¥: ${s.error}`,n.style.display="none"}catch(d){o.textContent=`âŒ å¯¼å…¥å¤±è´¥: ${d.message}`,n.style.display="none",console.error("GitHubå¯¼å…¥é”™è¯¯:",d)}finally{r.disabled=!1,r.textContent="å¼€å§‹å¯¼å…¥"}}async function se(){const t=document.getElementById("vercelToken"),e=document.getElementById("importVercelStatus"),o=document.getElementById("importVercelMessage"),n=document.getElementById("progressVercelBar"),i=document.getElementById("progressVercelFill"),r=document.getElementById("confirmImportVercelBtn"),a=t.value.trim();if(!a){alert("è¯·è¾“å…¥Vercel API Token");return}e.style.display="block",o.textContent="æ­£åœ¨è·å–Vercelé¡¹ç›®åˆ—è¡¨...",n.style.display="block",i.style.width="0%",r.disabled=!0,r.textContent="å¯¼å…¥ä¸­...";try{const d=[],s=await ee(a,l=>{d.push(l)});if(s.success){const l=A(d);i.style.width="100%",o.innerHTML=`
        âœ… å¯¼å…¥å®Œæˆï¼<br>
        å…±æ‰¾åˆ° ${s.total} ä¸ªé¡¹ç›®<br>
        æ–°å¢ ${l.added} ä¸ªé“¾æ¥<br>
        æ›´æ–° ${l.updated} ä¸ªé“¾æ¥ï¼ˆç‰ˆæœ¬å·å·²æ›´æ–°ï¼‰
      `,setTimeout(()=>{u("importVercelModal"),v()},3e3)}else o.textContent=`âŒ å¯¼å…¥å¤±è´¥: ${s.error}`,n.style.display="none"}catch(d){o.textContent=`âŒ å¯¼å…¥å¤±è´¥: ${d.message}`,n.style.display="none",console.error("Vercelå¯¼å…¥é”™è¯¯:",d)}finally{r.disabled=!1,r.textContent="å¼€å§‹å¯¼å…¥"}}function I(){const t=document.getElementById("importStatus"),e=document.getElementById("importMessage"),o=document.getElementById("progressBar"),n=document.getElementById("progressFill"),i=document.getElementById("confirmImportBtn"),r=document.getElementById("githubUsername");t&&(t.style.display="none"),e&&(e.textContent=""),o&&(o.style.display="none"),n&&(n.style.width="0%"),i&&(i.disabled=!1,i.textContent="å¼€å§‹å¯¼å…¥"),r&&(r.value="")}function v(){const t=document.getElementById("importVercelStatus"),e=document.getElementById("importVercelMessage"),o=document.getElementById("progressVercelBar"),n=document.getElementById("progressVercelFill"),i=document.getElementById("confirmImportVercelBtn"),r=document.getElementById("vercelToken");t&&(t.style.display="none"),e&&(e.textContent=""),o&&(o.style.display="none"),n&&(n.style.width="0%"),i&&(i.disabled=!1,i.textContent="å¼€å§‹å¯¼å…¥"),r&&(r.value="")}
