(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}})();const L="app_links";function C(){try{const t=localStorage.getItem(L);return t?JSON.parse(t):[]}catch(t){return console.error("è·å–é“¾æ¥å¤±è´¥:",t),[]}}function h(t){try{return localStorage.setItem(L,JSON.stringify(t)),!0}catch(e){return console.error("ä¿å­˜é“¾æ¥å¤±è´¥:",e),!1}}function M(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}let d=[],b=null,w=null;function $(){d=C(),g()}function x(t){var i;const e={id:M(),title:t.title.trim(),url:t.url.trim(),description:((i=t.description)==null?void 0:i.trim())||"",createdAt:new Date().toISOString()};return d.push(e),h(d),g(),e}function H(t,e){var o;const i=d.findIndex(n=>n.id===t);return i!==-1?(d[i]={...d[i],title:e.title.trim(),url:e.url.trim(),description:((o=e.description)==null?void 0:o.trim())||""},h(d),g(),d[i]):null}function O(t){d=d.filter(e=>e.id!==t),h(d),g()}function D(t){let e=0;return t.forEach(i=>{var n;if(!d.some(r=>r.url===i.url.trim())){const r={id:M(),title:i.title.trim(),url:i.url.trim(),description:((n=i.description)==null?void 0:n.trim())||"",createdAt:new Date().toISOString()};d.push(r),e++}}),e>0&&(h(d),g()),e}function G(){return b}function S(t){b=t}function U(){return w}function T(t){w=t}function F(t){if(t){let e=t;!t.startsWith("http://")&&!t.startsWith("https://")&&(e="https://"+t),window.open(e,"_blank","noopener,noreferrer")}}function g(){const t=document.getElementById("linksGrid"),e=document.getElementById("emptyState");!t||!e||(t.innerHTML="",d.length===0?(t.style.display="none",e.style.display="block"):(t.style.display="grid",e.style.display="none",d.forEach(i=>{const o=A(i);t.appendChild(o)})))}function A(t){const e=document.createElement("div");e.className="link-card",e.setAttribute("data-id",t.id);const i=P(t.url),o=i.charAt(0).toUpperCase();return e.innerHTML=`
    <div class="card-icon">${o}</div>
    <div class="card-content">
      <h3 class="card-title">${E(t.title)}</h3>
      ${t.description?`<p class="card-description">${E(t.description)}</p>`:""}
      <p class="card-url">${E(i)}</p>
    </div>
    <div class="card-actions">
      <button class="btn-icon btn-edit" data-id="${t.id}" aria-label="ç¼–è¾‘" title="ç¼–è¾‘">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
      </button>
      <button class="btn-icon btn-delete" data-id="${t.id}" aria-label="åˆ é™¤" title="åˆ é™¤">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="3 6 5 6 21 6"></polyline>
          <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        </svg>
      </button>
    </div>
  `,e.querySelector(".card-content").addEventListener("click",l=>{l.target.closest(".card-actions")||F(t.url)}),e.querySelector(".btn-edit").addEventListener("click",l=>{l.stopPropagation(),S(t.id),N(t),y("linkModal")}),e.querySelector(".btn-delete").addEventListener("click",l=>{l.stopPropagation(),T(t.id),y("deleteModal")}),e}function P(t){try{let e=t;return!t.startsWith("http://")&&!t.startsWith("https://")&&(e="https://"+t),new URL(e).hostname.replace("www.","")}catch{return t}}function E(t){const e=document.createElement("div");return e.textContent=t,e.innerHTML}function N(t){document.getElementById("linkId").value=t.id,document.getElementById("linkTitle").value=t.title,document.getElementById("linkUrl").value=t.url,document.getElementById("linkDescription").value=t.description||"",document.getElementById("modalTitle").textContent="ç¼–è¾‘é“¾æ¥"}function p(){document.getElementById("linkId").value="",document.getElementById("linkTitle").value="",document.getElementById("linkUrl").value="",document.getElementById("linkDescription").value="",document.getElementById("modalTitle").textContent="æ·»åŠ é“¾æ¥",S(null)}function y(t){const e=document.getElementById(t);e&&(e.style.display="flex",document.body.style.overflow="hidden")}function c(t){const e=document.getElementById(t);e&&(e.style.display="none",document.body.style.overflow="")}async function R(t){try{const e=[];let i=1,o=!0;for(;o;){const n=await fetch(`https://api.github.com/users/${t}/repos?per_page=100&page=${i}&sort=updated`);if(!n.ok)throw new Error(`GitHub APIé”™è¯¯: ${n.status}`);const r=await n.json();r.length===0?o=!1:(e.push(...r),i++,r.length<100&&(o=!1))}return e}catch(e){throw console.error("è·å–GitHubä»“åº“å¤±è´¥:",e),e}}function _(t,e,i="my-app2025"){return t.filter(o=>o.name!==i&&!o.fork).map(o=>{let n=o.homepage;n||(n=`https://${e}.github.io/${o.name}/`);const r=o.homepage||n;return{title:o.name,url:r,description:o.description||`GitHubåº”ç”¨: ${o.name}`,homepage:o.homepage,githubPagesUrl:n,repoUrl:o.html_url,stars:o.stargazers_count,language:o.language}}).sort((o,n)=>n.stars!==o.stars?n.stars-o.stars:0)}async function q(t,e){try{const i=await R(t),o=_(i,t);let n=0,r=0;const s=[];for(const l of o)try{const a=l.url;let u=l.description;l.language&&(u+=` | è¯­è¨€: ${l.language}`),l.stars>0&&(u+=` | â­ ${l.stars}`),l.homepage?u+=" | ğŸŒ å·²éƒ¨ç½²":u+=" | ğŸ“± GitHub Pages",e({title:l.title,url:a,description:u}),n++}catch(a){s.push({repo:l.title,error:a.message}),r++}return{success:!0,total:o.length,imported:n,skipped:r,errors:s}}catch(i){return{success:!1,error:i.message}}}document.addEventListener("DOMContentLoaded",()=>{$(),W()});function W(){const t=document.getElementById("addBtn");t&&t.addEventListener("click",()=>{p(),y("linkModal")});const e=document.getElementById("linkForm");e&&e.addEventListener("submit",j);const i=document.getElementById("closeModal");i&&i.addEventListener("click",()=>{c("linkModal"),p()});const o=document.getElementById("cancelBtn");o&&o.addEventListener("click",()=>{c("linkModal"),p()});const n=document.getElementById("confirmDeleteBtn");n&&n.addEventListener("click",J);const r=document.getElementById("cancelDeleteBtn");r&&r.addEventListener("click",()=>{c("deleteModal")});const s=document.getElementById("closeDeleteModal");s&&s.addEventListener("click",()=>{c("deleteModal")});const l=document.getElementById("linkModal");l&&l.addEventListener("click",m=>{m.target===l&&(c("linkModal"),p())});const a=document.getElementById("deleteModal");a&&a.addEventListener("click",m=>{m.target===a&&c("deleteModal")});const u=document.getElementById("importBtn");u&&u.addEventListener("click",()=>{y("importModal")});const B=document.getElementById("closeImportModal");B&&B.addEventListener("click",()=>{c("importModal"),f()});const v=document.getElementById("cancelImportBtn");v&&v.addEventListener("click",()=>{c("importModal"),f()});const k=document.getElementById("confirmImportBtn");k&&k.addEventListener("click",z);const I=document.getElementById("importModal");I&&I.addEventListener("click",m=>{m.target===I&&(c("importModal"),f())}),document.addEventListener("keydown",m=>{m.key==="Escape"&&(c("linkModal"),c("deleteModal"),c("importModal"),p(),f())})}function j(t){t.preventDefault();const e=document.getElementById("linkTitle").value.trim(),i=document.getElementById("linkUrl").value.trim(),o=document.getElementById("linkDescription").value.trim(),n=document.getElementById("linkId").value;if(!e||!i){alert("è¯·å¡«å†™æ ‡é¢˜å’ŒURL");return}const r={title:e,url:i,description:o},s=G();s&&n===s?H(s,r):x(r),c("linkModal"),p()}function J(){const t=U();t&&(O(t),c("deleteModal"))}async function z(){const t=document.getElementById("githubUsername"),e=document.getElementById("importStatus"),i=document.getElementById("importMessage"),o=document.getElementById("progressBar"),n=document.getElementById("progressFill"),r=document.getElementById("confirmImportBtn"),s=t.value.trim();if(!s){alert("è¯·è¾“å…¥GitHubç”¨æˆ·å");return}e.style.display="block",i.textContent="æ­£åœ¨è·å–GitHubä»“åº“åˆ—è¡¨...",o.style.display="block",n.style.width="0%",r.disabled=!0,r.textContent="å¯¼å…¥ä¸­...";try{const l=await q(s,a=>{D([a])});l.success?(n.style.width="100%",i.innerHTML=`
        âœ… å¯¼å…¥å®Œæˆï¼<br>
        å…±æ‰¾åˆ° ${l.total} ä¸ªä»“åº“<br>
        æˆåŠŸå¯¼å…¥ ${l.imported} ä¸ªé“¾æ¥<br>
        ${l.skipped>0?`è·³è¿‡ ${l.skipped} ä¸ªï¼ˆå¯èƒ½å·²å­˜åœ¨ï¼‰`:""}
      `,setTimeout(()=>{c("importModal"),f()},3e3)):(i.textContent=`âŒ å¯¼å…¥å¤±è´¥: ${l.error}`,o.style.display="none")}catch(l){i.textContent=`âŒ å¯¼å…¥å¤±è´¥: ${l.message}`,o.style.display="none",console.error("GitHubå¯¼å…¥é”™è¯¯:",l)}finally{r.disabled=!1,r.textContent="å¼€å§‹å¯¼å…¥"}}function f(){const t=document.getElementById("importStatus"),e=document.getElementById("importMessage"),i=document.getElementById("progressBar"),o=document.getElementById("progressFill"),n=document.getElementById("confirmImportBtn");t&&(t.style.display="none"),e&&(e.textContent=""),i&&(i.style.display="none"),o&&(o.style.width="0%"),n&&(n.disabled=!1,n.textContent="å¼€å§‹å¯¼å…¥")}
